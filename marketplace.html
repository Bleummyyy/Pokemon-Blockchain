<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PokéMarket</title>
  <link rel="stylesheet" href="css/marketplace.css"/>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="./js/marketplace.js"></script>  <!-- FIRST -->
  <script src="./js/login.js"></script>        <!-- LAST -->

  <!-- ETHERS.JS -->
</head>
<body>
  <!-- NAVBAR -->
<nav class="navbar">
  <div class="left-group">
    <div class="logo">Pokemon R</div>
    <div class="wallet-info" id="wallet-info" style="display: none;">
      Wallet: <span id="address">0x...</span>
    </div>
  </div>

  <div class="right-group">
    <a href="marketplace.html" class="nav-link">Marketplace</a>
    <a href="mynft.html" class="nav-link">Inventory</a>

    <!-- CONNECTED BUTTON -->
    <button class="nav-link login-btn" id="login-btn">
      <span>Login</span>
    </button>

    <!-- PROFILE IMAGE -->
    <img 
      src="https://avatars.githubusercontent.com/u/169036190?v=4&size=64" 
      alt="Profile" 
      class="nav-link profile-img" 
      onclick="toggleDropdown()">
  </div>
</nav>

<!-- DROPDOWN MENU -->
<div class="profile-dropdown" id="profile-dropdown" style="display: none;">
  <div class="dropdown-menu" id="dropdown-menu">
    <button onclick="logout()" class="logout-btn">Logout</button>
  </div>
</div>

  <!-- MAIN -->
  <div class="market-container">
    <header class="market-header">
      <h1>Pokémon NFT Marketplace</h1>

      <div class="filters-bar">
      <div class="filters">
        <!-- PRICE -->
        <select id="price-filter" onchange="applyFilters()">
          <option value="">Sort by Price</option>
          <option value="low">Low to High</option>
          <option value="high">High to Low</option>
        </select>

        <!-- RARITY -->
        <select id="rarity-filter" onchange="applyFilters()">
          <option value="">All Rarities</option>
          <option value="COMMON">Common</option>
          <option value="UNCOMMON">Uncommon</option>
          <option value="RARE">Rare</option>
          <option value="EPIC">Epic</option>
          <option value="LEGENDARY">Legendary</option>
        </select>

        <!-- TYPE -->
        <select id="type-filter" onchange="applyFilters()">
          <option value="">All Types</option>
          <option value="NORMAL">Normal</option>
          <option value="FIRE">Fire</option>
          <option value="WATER">Water</option>
          <option value="GRASS">Grass</option>
          <option value="ELECTRIC">Electric</option>
          <option value="ICE">Ice</option>
          <option value="FIGHTING">Fighting</option>
          <option value="POISON">Poison</option>
          <option value="GROUND">Ground</option>
          <option value="FLYING">Flying</option>
          <option value="PSYCHIC">Psychic</option>
          <option value="BUG">Bug</option>
          <option value="ROCK">Rock</option>
          <option value="GHOST">Ghost</option>
          <option value="DRAGON">Dragon</option>
          <option value="DARK">Dark</option>
          <option value="STEEL">Steel</option>
          <option value="FAIRY">Fairy</option>
        </select>

        <!-- SEARCH -->
        <input type="text" id="search-input" placeholder="Search Pokémon..." onkeyup="applyFilters()">
      </div>
    </div>
  </div>

      
      <!-- <p id="wallet-info" style="display:none;">
        Connected: <span id="address"></span>
      </p> -->
    </header>

    <!-- NFT GRID -->
    <div id="nfts-grid" class="nfts-grid">
      <p class="loading">Loading Pokémon...</p>
    </div>
  </div>

  <div class="pagination">
  <button id="prev-btn" onclick="changePage(currentPage - 1)" class="page-btn">Previous</button>
  
  <div id="page-numbers"></div>
  
  <button id="next-btn" onclick="changePage(currentPage + 1)" class="page-btn">Next</button>
</div>

  <!-- SCRIPTS -->
  <script>
    // Connect login button
    const loginBtn = document.getElementById("login-btn");
    if (loginBtn) {
      loginBtn.addEventListener("click", initMarketplace);
    }

    // Auto-load Pokémon
    window.addEventListener("load", () => {
      loadMarketplace();
    });
  </script>

<!-- At bottom of marketplace.html -->
  <script>
    // Auto-init if already connected
    window.addEventListener("load", () => {
      if (window.userAddress && typeof initMarketplace === "function") {
        initMarketplace();
      }
    });
  </script>

</body>
</html>